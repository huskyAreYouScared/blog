(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{214:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h3",{attrs:{id:"github-pages-actions-vuepress"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#github-pages-actions-vuepress"}},[t._v("#")]),t._v(" github pages+actions+vuepress")]),t._v(" "),a("ul",[a("li",[t._v("有一次看阮一峰老师的blog知道了actions"),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("传送门"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("在使用github提供的actions之前，我一直用的是netlify，由于处于好奇，研究了一下github的actions")]),t._v(" "),a("li",[t._v("最开始我是按照阮老师的blog操作的，所以一些关于 workflow, job, step, action的知识大家可以去看阮老师的blog")]),t._v(" "),a("li",[t._v("接下来会将我遇到的一些问题、还有和阮老师的blog不一样的地方，在这篇文章进行记录")])]),t._v(" "),a("h4",{attrs:{id:"首先是-github-密钥配置的不同之处"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首先是-github-密钥配置的不同之处"}},[t._v("#")]),t._v(" 首先是 GitHub 密钥配置的不同之处")]),t._v(" "),a("ul",[a("li",[t._v("我这里采用的是在本地生成公钥和私钥")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("  ssh-keygen -t rsa -b "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" -C "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" config user.email"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v('"')]),t._v(" -f gh-pages -N "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n")])])]),a("ul",[a("li",[a("p",[t._v("在运行这条命令的路径下会生成俩个文件gh-pages,gh-pages.pub\n"),a("img",{attrs:{src:t.$withBase("/image/pub-private-key.png"),alt:"dock"}})])]),t._v(" "),a("li",[a("p",[t._v("然后将公钥配置到项目的Setting/Deplog keys如下图\n"),a("img",{attrs:{src:t.$withBase("/image/config-pubkey.png"),alt:"dock"}})])]),t._v(" "),a("li",[a("p",[t._v("然后将私钥配置到项目的Setting/Secrets如下图\n"),a("img",{attrs:{src:t.$withBase("/image/config-privatekey.png"),alt:"dock"}})])]),t._v(" "),a("li",[a("p",[t._v("到这里密钥配置完成")])])]),t._v(" "),a("h4",{attrs:{id:"github-workflows用的是其他的actions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#github-workflows用的是其他的actions"}},[t._v("#")]),t._v(" .github/workflows用的是其他的actions")]),t._v(" "),a("ul",[a("li",[t._v("在这里先说一下，我开始用的是阮老师blog里那个workflows配置，对发布路径和其他的一些密钥配置稍加改造，但是GitHub actions 运行成功之后，我去访问我的那个主页，发现是404")]),t._v(" "),a("li",[t._v("后来经过Google发现要加上"),a("a",{attrs:{href:"https://github.community/t5/GitHub-Pages/GitHub-Pages-Builds-Fail/m-p/29184#M2000",target:"_blank",rel:"noopener noreferrer"}},[t._v(".nojekyll"),a("OutboundLink")],1),t._v("的空文件即可,但是后续又出现了问题，我更新文章的时候，GitHub actions也运行成功了但是blog就是不更新")]),t._v(" "),a("li",[t._v("后来才换了这个workflows")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("  name: vuepress build\n  on:\n    push:\n      branches:\n      - master\n  jobs:\n    build-deploy:\n      runs-on: ubuntu-18.04\n      steps:\n      - uses: actions/checkout@master\n      - run: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" ci "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装依赖")]),t._v("\n\n      - run: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vuepress打包命令 默认应该是（docs:build）")]),t._v("\n\n      - name: Deploy\n        uses: peaceiris/actions-gh-pages@v2.5.0\n        env:\n          ACTIONS_DEPLOY_KEY: "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${{ secrets.ACCESS_TOKEN_PRIVATE }")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 前面配的密钥，密钥名别写错")]),t._v("\n          PUBLISH_BRANCH: gh-pages "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# github pages 的发布分支")]),t._v("\n          PUBLISH_DIR: dist "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打包的目录")]),t._v("\n")])])]),a("ul",[a("li",[t._v("到这里就成功了，其他一些关于详细的配置可以去"),a("a",{attrs:{href:"https://help.github.com/cn/actions/automating-your-workflow-with-github-actions/events-that-trigger-workflows",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),a("OutboundLink")],1),t._v("查看")])])])}),[],!1,null,null,null);s.default=n.exports}}]);