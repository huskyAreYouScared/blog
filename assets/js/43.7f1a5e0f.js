(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{253:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"github-action使用体验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#github-action使用体验"}},[s._v("#")]),s._v(" github action使用体验")]),s._v(" "),a("ul",[a("li",[s._v("github pages+actions+vuepress")])]),s._v(" "),a("hr"),s._v(" "),a("ul",[a("li",[s._v("有一次看阮一峰老师的blog知道了actions"),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("传送门"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("在使用github提供的actions之前，我一直用的是netlify，由于处于好奇，研究了一下github的actions")]),s._v(" "),a("li",[s._v("最开始我是按照阮老师的blog操作的，所以一些关于 workflow, job, step, action的知识大家可以去看阮老师的blog")]),s._v(" "),a("li",[s._v("接下来会将我遇到的一些问题、还有和阮老师的blog不一样的地方，在这篇文章进行记录")])]),s._v(" "),a("h2",{attrs:{id:"首先是-github-密钥配置的不同之处"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首先是-github-密钥配置的不同之处"}},[s._v("#")]),s._v(" 首先是 GitHub 密钥配置的不同之处")]),s._v(" "),a("ul",[a("li",[s._v("我这里采用的是在本地生成公钥和私钥")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("  ssh-keygen -t rsa -b "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" -C "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config user.email"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" -f gh-pages -N "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("在运行这条命令的路径下会生成俩个文件gh-pages,gh-pages.pub\n"),a("img",{attrs:{src:s.$withBase("/image/pub-private-key.png"),alt:"dock"}})])]),s._v(" "),a("li",[a("p",[s._v("然后将公钥配置到项目的Setting/Deplog keys如下图\n"),a("img",{attrs:{src:s.$withBase("/image/config-pubkey.png"),alt:"dock"}})])]),s._v(" "),a("li",[a("p",[s._v("然后将私钥配置到项目的Setting/Secrets如下图\n"),a("img",{attrs:{src:s.$withBase("/image/config-privatekey.png"),alt:"dock"}})])]),s._v(" "),a("li",[a("p",[s._v("到这里密钥配置完成")])])]),s._v(" "),a("h2",{attrs:{id:"github-workflows用的是其他的actions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#github-workflows用的是其他的actions"}},[s._v("#")]),s._v(" .github/workflows用的是其他的actions")]),s._v(" "),a("ul",[a("li",[s._v("在这里先说一下，我开始用的是阮老师blog里那个workflows配置，对发布路径和其他的一些密钥配置稍加改造，但是GitHub actions 运行成功之后，我去访问我的那个主页，发现是404")]),s._v(" "),a("li",[s._v("后来经过Google发现要加上"),a("a",{attrs:{href:"https://github.community/t5/GitHub-Pages/GitHub-Pages-Builds-Fail/m-p/29184#M2000",target:"_blank",rel:"noopener noreferrer"}},[s._v(".nojekyll"),a("OutboundLink")],1),s._v("的空文件即可,但是后续又出现了问题，我更新文章的时候，GitHub actions也运行成功了但是blog就是不更新")]),s._v(" "),a("li",[s._v("后来才换了这个workflows")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("  name: vuepress build\n  on:\n    push:\n      branches:\n      - master\n  jobs:\n    build-deploy:\n      runs-on: ubuntu-18.04\n      steps:\n      - uses: actions/checkout@master\n      - run: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ci "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖")]),s._v("\n\n      - run: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vuepress打包命令 默认应该是（docs:build）")]),s._v("\n\n      - name: Deploy\n        uses: peaceiris/actions-gh-pages@v2.5.0\n        env:\n          ACTIONS_DEPLOY_KEY: "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${{ secrets.ACCESS_TOKEN_PRIVATE }")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 前面配的密钥，密钥名别写错")]),s._v("\n          PUBLISH_BRANCH: gh-pages "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# github pages 的发布分支")]),s._v("\n          PUBLISH_DIR: dist "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打包的目录")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("ul",[a("li",[s._v("到这里就成功了，其他一些关于详细的配置可以去"),a("a",{attrs:{href:"https://help.github.com/cn/actions/automating-your-workflow-with-github-actions/events-that-trigger-workflows",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1),s._v("查看")])])])}),[],!1,null,null,null);t.default=e.exports}}]);